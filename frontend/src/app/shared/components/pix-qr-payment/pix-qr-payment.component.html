<div class="pix-payment-container">
  <!-- Header -->
  <div class="payment-header">
    <div class="pix-logo">
      <span class="pix-icon">üì±</span>
      <h2>Pagamento PIX</h2>
    </div>
    <div class="amount-display">
      <span class="label">Valor:</span>
      <span class="value">{{ amount() | currencyFormat: 'BRL' }}</span>
    </div>
  </div>

  <!-- Status Badge -->
  <div class="status-badge" [ngClass]="paymentStatus()">
    @switch (paymentStatus()) {
      @case ('pending') {
        <span class="icon">‚è≥</span>
        <span>Aguardando pagamento...</span>
      }
      @case ('processing') {
        <span class="icon">üîÑ</span>
        <span>Processando...</span>
      }
      @case ('succeeded') {
        <span class="icon">‚úÖ</span>
        <span>Pagamento confirmado!</span>
      }
      @case ('expired') {
        <span class="icon">‚è∞</span>
        <span>PIX expirado</span>
      }
      @case ('failed') {
        <span class="icon">‚ùå</span>
        <span>Pagamento falhou</span>
      }
    }
  </div>

  @if (paymentStatus() === 'pending' || paymentStatus() === 'processing') {
    <!-- QR Code Section -->
    <div class="qr-section">
      <div class="qr-code-wrapper">
        @if (pixPaymentString()) {
          <qrcode
            [qrdata]="pixPaymentString()"
            [width]="256"
            [errorCorrectionLevel]="'M'"
            [cssClass]="'qr-code'"
          ></qrcode>
        }
      </div>

      <p class="qr-instruction">Escaneie o QR Code com o app do seu banco</p>

      @if (expiresAt()) {
        <div class="expiration-timer">
          <span class="icon">‚è±Ô∏è</span>
          <span>Expira em: {{ timeRemaining() }}</span>
        </div>
      }

      <button class="download-btn" (click)="downloadQRCode()">
        <span class="icon">üíæ</span>
        Baixar QR Code
      </button>
    </div>

    <!-- PIX Copy & Paste -->
    <div class="pix-string-section">
      <h3>Ou copie o c√≥digo PIX</h3>
      <div class="code-container">
        <code class="pix-code">{{ pixPaymentString() }}</code>
        <button
          class="copy-btn"
          [class.copied]="copied()"
          (click)="copyToClipboard()">
          @if (copied()) {
            <span>‚úì Copiado!</span>
          } @else {
            <span>üìã Copiar</span>
          }
        </button>
      </div>
    </div>

    <!-- Instructions -->
    <div class="instructions">
      <h4>Como pagar</h4>
      <ol>
        <li>Abra o aplicativo do seu banco</li>
        <li>Escolha a op√ß√£o <strong>PIX</strong></li>
        <li>Selecione <strong>Pagar com QR Code</strong></li>
        <li>Escaneie o c√≥digo acima ou cole o c√≥digo copiado</li>
        <li>Confirme o pagamento</li>
        <li>Aguarde a confirma√ß√£o autom√°tica</li>
      </ol>
    </div>
  }

  @if (paymentStatus() === 'succeeded') {
    <div class="success-message">
      <div class="success-icon">üéâ</div>
      <h3>Pagamento confirmado!</h3>
      <p>Obrigado pela sua doa√ß√£o. O recibo foi enviado para o seu e-mail.</p>
    </div>
  }

  @if (paymentStatus() === 'expired' || paymentStatus() === 'failed') {
    <div class="error-message">
      <div class="error-icon">üòî</div>
      <h3>Pagamento n√£o conclu√≠do</h3>
      <p>{{ paymentStatus() === 'expired' ? 'O c√≥digo PIX expirou.' : 'Ocorreu um erro no pagamento.' }}</p>
      <p>Por favor, tente novamente.</p>
    </div>
  }
</div>
