<div class="ong-detail-screen">
  <!-- Loading -->
  @if (loading()) {
  <div class="loading">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <span class="loading-text">Carregando...</span>
    </div>
  </div>
  } @else if (ong()) {

  <!-- Back Button -->
  <button class="back-button" (click)="goBack()">
    <svg viewBox="0 0 24 24" fill="currentColor">
      <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
    </svg>
    Voltar
  </button>

  <!-- Header with Image -->
  <div class="ong-header">
    <div class="ong-image-container">
      @if (ong()!.profileImageUrl) {
      <img
        [ngSrc]="ong()!.profileImageUrl!"
        [alt]="ong()!.ongName"
        fill
        class="ong-image"
        priority
        sizes="100vw"
      />
      } @else {
      <div class="placeholder-image">
        <svg class="placeholder-icon" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M16.5 12c1.38 0 2.49-1.12 2.49-2.5S17.88 7 16.5 7C15.12 7 14 8.12 14 9.5s1.12 2.5 2.5 2.5zM9 11c1.66 0 2.99-1.34 2.99-3S10.66 5 9 5C7.34 5 6 6.34 6 8s1.34 3 3 3zm7.5 3c-1.83 0-5.5.92-5.5 2.75V19h11v-2.25c0-1.83-3.67-2.75-5.5-2.75zM9 13c-2.33 0-7 1.17-7 3.5V19h7v-2.25c0-.85.33-2.34 2.37-3.47C10.5 13.1 9.66 13 9 13z"
          />
        </svg>
      </div>
      }
    </div>

    <div class="ong-header-info">
      <h1 class="ong-name">{{ ong()!.ongName }}</h1>

      @if (ong()!.location) {
      <div class="ong-location">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"
          />
        </svg>
        <span>{{ ong()!.location }}</span>
      </div>
      }

      <div class="pet-count">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <circle cx="8" cy="6" r="2" />
          <circle cx="16" cy="6" r="2" />
          <circle cx="6" cy="12" r="2" />
          <circle cx="18" cy="12" r="2" />
          <ellipse cx="12" cy="16" rx="4" ry="3" />
        </svg>
        <span>{{ ong()!.petCount }} pets disponíveis para adoção</span>
      </div>
    </div>
  </div>

  <!-- Contact Buttons -->
  <div class="contact-section">
    <h2 class="section-title">Entrar em Contato</h2>
    <div class="contact-buttons">
      @if (ong()!.phone) {
      <button class="contact-button phone" (click)="contactOng('phone')">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"
          />
        </svg>
        <span>{{ ong()!.phone }}</span>
      </button>
      }

      <button class="contact-button email" (click)="contactOng('email')">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
          />
        </svg>
        <span>{{ ong()!.email }}</span>
      </button>

      @if (ong()!.instagramHandle) {
      <button class="contact-button instagram" (click)="contactOng('instagram')">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"
          />
        </svg>
        <span>{{ ong()!.instagramHandle }}</span>
      </button>
      }
    </div>
  </div>

  <!-- Needs Section -->
  @if (ong()!.needs.length > 0) {
  <div class="needs-section">
    <h2 class="section-title highlight">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path
          d="M12 2L1 21h22L12 2zm0 3.99L19.53 19H4.47L12 5.99zM11 16h2v2h-2zm0-6h2v4h-2z"
        />
      </svg>
      Necessidades Urgentes
    </h2>

    <div class="needs-grid">
      @for (need of ong()!.needs; track need.id) {
      <div
        class="need-card"
        [style.border-left-color]="getPriorityColor(need.priority)"
      >
        <div class="need-header">
          <div class="need-category">
            <span class="category-icon">{{ getCategoryIcon(need.category) }}</span>
            <span class="category-label">{{ getCategoryLabel(need.category) }}</span>
          </div>
          <span
            class="need-priority"
            [style.background]="getPriorityColor(need.priority)"
          >
            {{ getPriorityLabel(need.priority) }}
          </span>
        </div>

        <h3 class="need-title">{{ need.title }}</h3>
        <p class="need-description">{{ need.description }}</p>

        @if (need.targetAmount) {
        <div class="need-amount">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"
            />
          </svg>
          <span>Meta: €{{ need.targetAmount }}</span>
        </div>
        }
      </div>
      }
    </div>
  </div>
  } @else {
  <div class="no-needs">
    <svg viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
      />
    </svg>
    <p>Esta ONG não possui necessidades urgentes no momento</p>
  </div>
  }

  <!-- View Pets Button -->
  @if (ong()!.petCount > 0) {
  <button class="view-pets-button" (click)="viewPets()">
    <svg viewBox="0 0 24 24" fill="currentColor">
      <circle cx="8" cy="6" r="2" />
      <circle cx="16" cy="6" r="2" />
      <circle cx="6" cy="12" r="2" />
      <circle cx="18" cy="12" r="2" />
      <ellipse cx="12" cy="16" rx="4" ry="3" />
    </svg>
    Ver Pets para Adoção ({{ ong()!.petCount }})
  </button>
  } }
</div>
